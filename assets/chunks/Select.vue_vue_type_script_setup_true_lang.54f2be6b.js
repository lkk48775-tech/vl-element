import{d as B,e as g,w as M,f as h,a8 as P,o as i,c as f,D as p,z as m,F as U,K as W,n as b,$ as k,b as C,y as $}from"./framework.270c351a.js";import{d as q,_ as j}from"./Tooltip.vue_vue_type_script_setup_true_lang.f5a83440.js";import{_ as G}from"./Input.vue_vue_type_script_setup_true_lang.aafb1ade.js";import{_ as y,i as F}from"./Icon.vue_vue_type_script_setup_true_lang.718b8100.js";import{R as J}from"./RenderVnode.470b819f.js";const Q={key:0,class:"vk-select__loading"},T={key:1,class:"vk-select__nodata"},X={key:2,class:"vk-select__menu"},Y=["id","onClick"],Z=B({name:"VLSelect"}),ie=B({...Z,props:{modelValue:null,options:{default:()=>[]},placeholder:null,disabled:{type:Boolean},clearable:{type:Boolean},renderLabel:{type:Function},filterable:{type:Boolean},filterMethod:{type:Function},remote:{type:Boolean},remoteMethod:{type:Function}},emits:["change","update:modelValue","visible-change","clear"],setup(s,{emit:u}){const t=s,x=l=>{const n=t.options.find(a=>a.value===l);return n||null},D=g(()=>t.remote?300:0);let c=x(t.modelValue);M(()=>t.modelValue,l=>{c?c.value=l:c=x(l)});const v=h(),_=h(),e=P({inputValue:c?c.label:"",selectedOption:c,mouseHover:!1,loading:!1,highlightIndex:-1}),r=h(!1),R={modifiers:[{name:"offset",options:{offset:[0,9]}},{name:"sameWidth",enabled:!0,fn:({state:l})=>{l.styles.popper.width=`${l.rects.reference.width}px`},phase:"beforeWrite",requires:["computeStyles"]}]},o=h(t.options);M(()=>t.options,l=>{o.value=l});const w=async l=>{if(t.filterable){if(t.filterMethod&&F(t.filterMethod))o.value=t.filterMethod(l);else if(t.remote&&t.remoteMethod&&F(t.remoteMethod)){e.loading=!0;try{o.value=await t.remoteMethod(l)}catch(n){console.error(n),o.value=[]}finally{e.loading=!1}}else o.value=t.options.filter(n=>n.label.includes(l));e.highlightIndex=-1}},L=()=>{w(e.inputValue)},H=q(()=>{L()},D.value),N=g(()=>t.filterable&&e.selectedOption&&r.value?e.selectedOption.label:t.placeholder),d=l=>{l?(t.filterable&&e.selectedOption&&(e.inputValue=""),t.filterable&&w(e.inputValue),v.value.show()):(v.value.hide(),t.filterable&&(e.inputValue=e.selectedOption?e.selectedOption.label:""),e.highlightIndex=-1),r.value=l,u("visible-change",l)},S=l=>{switch(l.key){case"Enter":r.value?e.highlightIndex>-1&&o.value[e.highlightIndex]?O(o.value[e.highlightIndex]):d(!1):d(!0);break;case"Escape":r.value&&d(!1);break;case"ArrowUp":l.preventDefault(),o.value.length>0&&(e.highlightIndex===-1||e.highlightIndex===0?e.highlightIndex=o.value.length-1:e.highlightIndex--);break;case"ArrowDown":l.preventDefault(),o.value.length>0&&(e.highlightIndex===-1||e.highlightIndex===o.value.length-1?e.highlightIndex=0:e.highlightIndex++);break}},E=g(()=>t.clearable&&e.mouseHover&&e.selectedOption&&e.inputValue.trim()!==""),K=()=>{e.selectedOption=null,e.inputValue="",u("clear"),u("change",""),u("update:modelValue","")},z=()=>{},A=()=>{t.disabled||(r.value?d(!1):d(!0))},O=l=>{l.disabled||(e.inputValue=l.label,e.selectedOption=l,u("change",l.value),u("update:modelValue",l.value),d(!1),_.value.ref.focus())};return(l,n)=>(i(),f("div",{class:b(["vk-select",{"is-disabled":s.disabled}]),onClick:A,onMouseenter:n[2]||(n[2]=a=>e.mouseHover=!0),onMouseleave:n[3]||(n[3]=a=>e.mouseHover=!1)},[p(j,{placement:"bottom-start",ref_key:"tooltipRef",ref:v,popperOptions:R,onClickOutside:n[1]||(n[1]=a=>d(!1)),manual:""},{content:m(()=>[e.loading?(i(),f("div",Q,[p(y,{icon:"spinner",spin:""})])):s.filterable&&o.value.length===0?(i(),f("div",T,"no matching data")):(i(),f("ul",X,[(i(!0),f(U,null,W(o.value,(a,V)=>{var I;return i(),f("li",{key:V,class:b(["vk-select__menu-item",{"is-disabled":a.disabled,"is-selected":((I=e.selectedOption)==null?void 0:I.value)===a.value,"is-highlighted":e.highlightIndex===V}]),id:`select-item-${a.value}`,onClick:k(ee=>O(a),["stop"])},[p(C(J),{vNode:s.renderLabel?s.renderLabel(a):a.label},null,8,["vNode"])],10,Y)}),128))]))]),default:m(()=>[p(G,{modelValue:e.inputValue,"onUpdate:modelValue":n[0]||(n[0]=a=>e.inputValue=a),disabled:s.disabled,placeholder:N.value,ref_key:"inputRef",ref:_,readonly:!s.filterable||!r.value,onInput:C(H),onKeydown:S},{suffix:m(()=>[E.value?(i(),$(y,{key:0,icon:"circle-xmark",class:"vk-input__clear",onMousedown:k(z,["prevent"]),onClick:k(K,["stop"])},null,8,["onMousedown","onClick"])):(i(),$(y,{key:1,icon:"angle-down",class:b(["header-angle",{"is-active":r.value}])},null,8,["class"]))]),_:1},8,["modelValue","disabled","placeholder","readonly","onInput"])]),_:1},512)],34))}});export{ie as _};
